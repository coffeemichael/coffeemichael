<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ÎßàÏù¥ÌÅ¥Î¶¨Î∑∞</title>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<style>
  body {
    font-family: 'Arial', sans-serif;
    background-color: #2c6591;
    margin: 0;
    padding: 0;
    color: #000;
  }
  header {
    text-align: center;
    padding: 30px 0 10px;
    font-size: 40px;
    font-weight: bold;
    color: white;
  }
  .menu {
    display: flex;
    justify-content: center;
    gap: 20px;
    margin-top: 10px;
  }
  .menu-button {
    padding: 10px 20px;
    font-size: 16px;
    border-radius: 20px;
    font-weight: bold;
    background-color: white;
    cursor: pointer;
    border: none;
  }
  .search-container {
    display: flex;
    justify-content: center;
    margin-top: 20px;
  }
  .search-container input[type="text"] {
    width: 300px;
    padding: 10px;
    font-size: 16px;
    border: none;
    border-radius: 5px 0 0 5px;
  }
  .search-container button {
    padding: 10px;
    font-size: 16px;
    border: none;
    background-color: #fff;
    border-radius: 0 5px 5px 0;
    cursor: pointer;
  }
  .coffee-list {
    display: grid;
    grid-template-columns: repeat(4, minmax(0, 1fr)); /* Ìïú Ï§Ñ 4Í∞ú */
    gap: 20px;
    padding: 20px;
    justify-items: center;
  }
  .coffee-card {
    background-color: white;
    border-radius: 12px;
    width: 100%;
    max-width: 280px;
    text-align: center;
    padding: 10px;
  }
  .coffee-card img {
    width: 100%;
    border-radius: 8px;
  }
  .coffee-card .name {
    font-size: 16px;
    font-weight: bold;
    margin: 10px 0 5px;
  }
  .coffee-card .distance {
    font-size: 14px;
  }
</style>
</head>
<body>

<header>ÎßàÏù¥ÌÅ¥Î¶¨Î∑∞</header>

<div class="menu">
  <button class="menu-button">ÏÑúÏö∏</button>
  <button class="menu-button">CUP</button>
</div>

<div class="search-container">
  <input type="text" placeholder="Ïª§ÌîºÏàç Í≤ÄÏÉâÌïòÍ∏∞" id="searchInput">
  <button onclick="searchShop()">üîç</button>
</div>

<div id="coffee-list" class="coffee-list">Î°úÎî© Ï§ë...</div>

<script>
const API_KEY = "357B35E8-AEBD-33AD-981C-F87C4112052C";

// ÏÉòÌîå 10Í∞ú Îç∞Ïù¥ÌÑ∞
const shops = [
  { name: "Lowkey", address: "ÏÑúÏö∏ ÏÑ±ÎèôÍµ¨ Ïó∞Î¨¥Ïû•3Í∏∏ 6 1Ï∏µ", img: "1.png" },
  { name: "Gimisa", address: "ÏÑúÏö∏ ÏÑ±ÎèôÍµ¨ ÏÑ±ÏàòÏù¥Î°ú26Í∏∏ 47 ÏßÄÌïò1Ï∏µ", img: "2.png" },
  { name: "Coffee Graffiti", address: "ÏÑúÏö∏ ÏòÅÎì±Ìè¨Íµ¨ ÏñëÌèâÎ°ú28Îã§Í∏∏ 3 1Ï∏µ", img: "3.png" },
  { name: "The Barn", address: "ÏÑúÏö∏ ÏÑ±ÎèôÍµ¨ ÎöùÏÑ¨Î°ú17Í∏∏ 31-22 1Ï∏µ", img: "4.png" },
  { name: "Center Coffee", address: "ÏÑúÏö∏ ÏÑ±ÎèôÍµ¨ ÏÑúÏö∏Ïà≤2Í∏∏ 28-11 1Ï∏µ", img: "5.png" },
  { name: "Coffee Montage", address: "ÏÑúÏö∏ Í∞ïÎèôÍµ¨ Ïò¨Î¶ºÌîΩÎ°ú48Í∏∏ 23-12 1Ï∏µ", img: "6.png" },
  { name: "Peer Coffee", address: "ÏÑúÏö∏ ÏÑ±ÎèôÍµ¨ Í¥ëÎÇòÎ£®Î°ú4Í∞ÄÍ∏∏ 24 1Ï∏µ", img: "7.png" },
  { name: "Gary Gristmill", address: "ÏÑúÏö∏ Í∞ïÎÇ®Íµ¨ ÏïïÍµ¨Ï†ï2Í∏∏ 15 ÏßÄÌïò1Ï∏µ", img: "8.png" },
  { name: "Tailor Coffee", address: "ÏÑúÏö∏ Í∞ïÎÇ®Íµ¨ Í∞ïÎÇ®ÎåÄÎ°ú160Í∏∏ 31 1Ï∏µ", img: "9.png" },
  { name: "Biroso Coffee", address: "ÏÑúÏö∏ ÎßàÌè¨Íµ¨ Í¥ëÏÑ±Î°ú6Í∏∏ 42 1Ï∏µ", img: "10.png" }
];

// Í±∞Î¶¨ Í≥ÑÏÇ∞
function getDistance(lat1, lon1, lat2, lon2) {
  const R = 6371;
  const dLat = (lat2 - lat1) * Math.PI / 180;
  const dLon = (lon2 - lon1) * Math.PI / 180;
  const a = Math.sin(dLat / 2) ** 2 +
            Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *
            Math.sin(dLon / 2) ** 2;
  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
  return (R * c).toFixed(2);
}

// VWorld JSONP Ï¢åÌëú Î≥ÄÌôò
function getCoords(shop, callback) {
  $.ajax({
    url: "https://api.vworld.kr/req/address?",
    type: "GET",
    dataType: "jsonp",
    data: {
      service: "address",
      request: "GetCoord",
      version: "2.0",
      crs: "EPSG:4326",
      type: "ROAD",
      address: shop.address,
      format: "json",
      key: API_KEY
    },
    success: function(result) {
      if (result.response && result.response.status === "OK") {
        shop.lat = parseFloat(result.response.result.point.y);
        shop.lon = parseFloat(result.response.result.point.x);
      }
      callback();
    }
  });
}

// Ïπ¥Îìú Ï∂úÎ†•
function renderShops(list) {
  const container = $("#coffee-list");
  container.html("");
  list.forEach(shop => {
    container.append(`
      <div class="coffee-card">
        <img src="${shop.img}" alt="${shop.name}">
        <div class="name">${shop.name}</div>
        <div class="distance">${shop.distance ? shop.distance + "km" : "Í≥ÑÏÇ∞Ï§ë..."}</div>
      </div>
    `);
  });
}

// Í≤ÄÏÉâ Í∏∞Îä•
function searchShop() {
  const keyword = $("#searchInput").val().toLowerCase();
  const filtered = shops.filter(s => s.name.toLowerCase().includes(keyword));
  renderShops(filtered);
}

// Ï¥àÍ∏∞Ìôî
function init() {
  if (!navigator.geolocation) {
    alert("ÏúÑÏπò Í∂åÌïúÏù¥ ÌïÑÏöîÌï©ÎãàÎã§!");
    return;
  }

  navigator.geolocation.getCurrentPosition(pos => {
    const myLat = pos.coords.latitude;
    const myLon = pos.coords.longitude;

    let count = 0;
    shops.forEach(shop => {
      getCoords(shop, () => {
        if (shop.lat && shop.lon) {
          shop.distance = getDistance(myLat, myLon, shop.lat, shop.lon);
        } else {
          shop.distance = "??";
        }
        count++;
        if (count === shops.length) {
          shops.sort((a, b) => parseFloat(a.distance) - parseFloat(b.distance));
          renderShops(shops);
        }
      });
    });
  });
}

$(document).ready(init);
</script>

</body>
</html>