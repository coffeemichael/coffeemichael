<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ÎßàÏù¥ÌÅ¥Î¶¨Î∑∞ - Ïã§ÏãúÍ∞Ñ Í±∞Î¶¨Ïàú</title>
  <style>
    body {
      font-family: 'Arial', sans-serif;
      background-color: #2c6591;
      margin: 0;
      padding: 0;
      color: #000;
    }
    header {
      text-align: center;
      padding: 30px 0 10px;
      font-size: 40px;
      font-weight: bold;
      color: white;
    }
    .menu {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-top: 10px;
    }
    .dropdown {
      position: relative;
      display: inline-block;
    }
    .dropdown-content {
      display: none;
      position: absolute;
      background-color: white;
      min-width: 120px;
      box-shadow: 0px 8px 16px rgba(0,0,0,0.2);
      z-index: 1;
      border-radius: 8px;
      font-size: 16px;
    }
    .dropdown-content div {
      padding: 8px 12px;
      cursor: pointer;
    }
    .dropdown-content div:hover {
      background-color: #eaeaea;
    }
    .menu-button {
      padding: 10px 20px;
      font-size: 16px;
      border-radius: 20px;
      font-weight: bold;
      background-color: white;
      cursor: pointer;
    }
    .search-container {
      display: flex;
      justify-content: center;
      margin-top: 20px;
    }
    .search-container input[type="text"] {
      width: 300px;
      padding: 10px;
      font-size: 16px;
      border: none;
      border-radius: 5px 0 0 5px;
    }
    .search-container button {
      padding: 10px;
      font-size: 16px;
      border: none;
      background-color: #fff;
      border-radius: 0 5px 5px 0;
    }
    .coffee-list {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 20px;
      padding: 20px;
    }
    .coffee-card {
      background-color: white;
      border-radius: 12px;
      width: 30%;
      min-width: 200px;
      max-width: 300px;
      text-align: center;
      padding: 10px;
    }
    .coffee-card img {
      width: 100%;
      border-radius: 8px;
    }
    .coffee-card .name {
      font-size: 16px;
      font-weight: bold;
      margin: 10px 0 5px;
    }
    .coffee-card .distance {
      font-size: 14px;
    }
  </style>
</head>
<body>

<header>ÎßàÏù¥ÌÅ¥Î¶¨Î∑∞</header>

<div class="menu">
  <div class="dropdown">
    <div class="menu-button">ÏÑúÏö∏</div>
    <div class="dropdown-content">
      <div onclick="filterByRegion('Í∞ïÎèô')">Í∞ïÎèô</div>
      <div onclick="filterByRegion('Í∞ïÏÑú')">Í∞ïÏÑú</div>
      <div onclick="filterByRegion('Ï§ëÏïô')">Ï§ëÏïô</div>
      <div onclick="filterByRegion('Í∞ïÎÇ®')">Í∞ïÎÇ®</div>
      <div onclick="filterByRegion('Í∞ïÎ∂Å')">Í∞ïÎ∂Å</div>
    </div>
  </div>

  <div class="dropdown">
    <div class="menu-button">CUP</div>
    <div class="dropdown-content">
      <div onclick="filterByCup('Perfect Cup')">Perfect Cup</div>
      <div onclick="filterByCup('Phenomenal Cup')">Phenomenal Cup</div>
      <div onclick="filterByCup('Awesome Cup')">Awesome Cup</div>
      <div onclick="filterByCup('Hot Issue')">Hot Issue</div>
      <div onclick="filterByCup('Nearby')">Nearby</div>
    </div>
  </div>
</div>

<div class="search-container">
  <input type="text" placeholder="Ïª§ÌîºÏàç Í≤ÄÏÉâÌïòÍ∏∞">
  <button>üîç</button>
</div>

<div id="coffee-list" class="coffee-list">Î°úÎî© Ï§ë...</div>

<script>
  const API_KEY = "357B35E8-AEBD-33AD-981C-F87C4112052C"; // V-World API Key

  // Ïª§ÌîºÏàç Îç∞Ïù¥ÌÑ∞ (ÏúÑÍ≤ΩÎèÑ null ‚Üí APIÎ°ú ÏûêÎèô Î≥ÄÌôò)
  const shops =[
  { no: 1, name: "Lowkey", address: "ÏÑúÏö∏ ÏÑ±ÎèôÍµ¨ Ïó∞Î¨¥Ïû•3Í∏∏ 6 1Ï∏µ", img: "1.png" },
  { no: 2, name: "Coffee Graffiti", address: "ÏÑúÏö∏ ÏòÅÎì±Ìè¨Íµ¨ ÏñëÌèâÎ°ú28Îã§Í∏∏ 3", img: "2.png" },
  { no: 3, name: "Gimisa", address: "ÏÑúÏö∏ ÏÑ±ÎèôÍµ¨ ÏÑ±ÏàòÏù¥Î°ú26Í∏∏ 47 ÏßÄÌïò1, 1Ï∏µ", img: "3.png" },
  { no: 4, name: "The Barn", address: "ÏÑúÏö∏ ÏÑ±ÎèôÍµ¨ ÎöùÏÑ¨Î°ú17Í∏∏ 31-22", img: "4.png" },
  { no: 5, name: "Center Coffee", address: "ÏÑúÏö∏ ÏÑ±ÎèôÍµ¨ ÏÑúÏö∏Ïà≤2Í∏∏ 28-11", img: "5.png" },
  { no: 6, name: "Coffee Montage", address: "ÏÑúÏö∏ Í∞ïÎèôÍµ¨ Ïò¨Î¶ºÌîΩÎ°ú48Í∏∏ 23-12 1Ï∏µ", img: "6.png" },
  { no: 7, name: "Peer Coffee", address: "ÏÑúÏö∏ ÏÑ±ÎèôÍµ¨ Í¥ëÎÇòÎ£®Î°ú4Í∞ÄÍ∏∏ 24", img: "7.png" },
  { no: 8, name: "Gary Gristmill", address: "ÏÑúÏö∏ Í∞ïÎÇ®Íµ¨ ÏïïÍµ¨Ï†ï2Í∏∏ 15 ÏßÄÌïò1Ï∏µ 103", img: "8.png" },
  { no: 9, name: "Tailor Coffee", address: "ÏÑúÏö∏ Í∞ïÎÇ®Íµ¨ Í∞ïÎÇ®ÎåÄÎ°ú160Í∏∏ 31 1Ï∏µ", img: "9.png" },
  { no: 10, name: "Biroso Coffee", address: "ÏÑúÏö∏ ÎßàÌè¨Íµ¨ Í¥ëÏÑ±Î°ú6Í∏∏ 42 1Ï∏µ", img: "10.png" },
  { no: 11, name: "Milo Coffee", address: "ÏÑúÏö∏ ÎßàÌè¨Íµ¨ ÎèôÍµêÎèô 170-33", img: "11.png" },
  { no: 12, name: "Deep Blue Lake", address: "ÏÑúÏö∏ ÎßàÌè¨Íµ¨ Ìè¨ÏùÄÎ°ú6Í∏∏ 11", img: "12.png" },
  { no: 13, name: "Coffee Libere", address: "ÏÑúÏö∏ ÏòÅÎì±Ìè¨Íµ¨ ÏòÅÏ§ëÎ°ú 15 ÌÉÄÏûÑÏä§ÌÄòÏñ¥ 1Ï∏µ 112Ìò∏", img: "13.png" },
  { no: 14, name: "TXT Coffee", address: "ÏÑúÏö∏ Ï¢ÖÎ°úÍµ¨ Ï∞ΩÎçïÍ∂ÅÍ∏∏ 121", img: "14.png" },
  { no: 15, name: "Namusairo", address: "ÏÑúÏö∏ Ï¢ÖÎ°úÍµ¨ ÏÇ¨ÏßÅÎ°ú8Í∏∏ 21 1Ï∏µ", img: "15.png" },
  { no: 16, name: "Felt Coffee", address: "ÏÑúÏö∏ Ï¢ÖÎ°úÍµ¨ Ï¢ÖÎ°ú3Í∏∏ 17 B2Ï∏µ", img: "16.png" },
  { no: 17, name: "Champ Coffee", address: "ÏÑúÏö∏ Ïö©ÏÇ∞Íµ¨ ÎÖπÏÇ¨ÌèâÎåÄÎ°ú26Í∞ÄÍ∏∏ 24 1Ï∏µ", img: "17.png" },
  { no: 18, name: "Bamaself", address: "ÏÑúÏö∏ Ïö©ÏÇ∞Íµ¨ ÏõêÌö®Î°ú89Í∏∏ 12", img: "18.png" },
  { no: 19, name: "Liike Coffee", address: "ÏÑúÏö∏ ÏÑ±Î∂ÅÍµ¨ Î≥¥Î¨∏Î°ú34Í∞ÄÍ∏∏ 24 1Ï∏µ", img: "19.png" },
  { no: 20, name: "Gabaemihon", address: "ÏÑúÏö∏ ÎèÑÎ¥âÍµ¨ ÎèÑÎ¥âÎ°ú115Í∏∏ 4", img: "20.png" }
{ no: 21, name: "Loose Door", address: "ÏÑúÏö∏ ÎßàÌè¨Íµ¨ Ìè¨ÏùÄÎ°ú 50", img: "21.png" },
  { no: 22, name: "Brewing Ceremony", address: "ÏÑúÏö∏ ÏÑ±ÎèôÍµ¨ Ïó∞Î¨¥Ïû•5Í∞ÄÍ∏∏ 22-1", img: "22.png" },
  { no: 23, name: "Vision Stroll", address: "ÏÑúÏö∏ ÎßàÌè¨Íµ¨ ÎßùÏõêÎ°ú61 1Ï∏µ", img: "23.png" },
  { no: 24, name: "Monsieurbubu", address: "ÏÑúÏö∏ ÎßàÌè¨Íµ¨ ÎßùÏõêÎ°ú 13", img: "24.png" },
  { no: 25, name: "New Wave", address: "ÏÑúÏö∏ ÏñëÏ≤úÍµ¨ Ïã†Î™©Î°ú2Í∏∏ 35-1 1Ï∏µ", img: "25.png" },
  { no: 26, name: "Bean Brothers", address: "ÏÑúÏö∏ ÎßàÌè¨Íµ¨ ÌÜ†Ï†ïÎ°ú 35-1", img: "26.png" },
  { no: 27, name: "Brobell Coffee", address: "ÏÑúÏö∏ ÏÑ±ÎèôÍµ¨ ÎöùÏÑ¨Î°ú 413 1Ï∏µ", img: "27.png" },
  { no: 28, name: "Wicker Park", address: "ÏÑúÏö∏ ÏÜ°ÌååÍµ¨ ÏÑùÏ¥åÌò∏ÏàòÎ°ú 298 Ïû†Ïã§ÎåÄÏö∞Î†àÏù¥ÌÅ¨ÏõîÎìú 103-1Ìò∏", img: "28.png" },
  { no: 29, name: "Frolla", address: "ÏÑúÏö∏ ÏÑ±ÎèôÍµ¨ Ïó∞Î¨¥Ïû•17Í∏∏ 5", img: "29.png" },
  { no: 30, name: "Come To Rest", address: "ÏÑúÏö∏ ÎèôÎåÄÎ¨∏Íµ¨ ÌöåÍ∏∞Î°ú 161-11", img: "30.png" },
  { no: 31, name: "Frizt Coffee", address: "ÏÑúÏö∏ Ï¢ÖÎ°úÍµ¨ Ïú®Í≥°Î°ú 83", img: "31.png" },
  { no: 32, name: "Travertine", address: "ÏÑúÏö∏ Ïö©ÏÇ∞Íµ¨ ÌïúÍ∞ïÎåÄÎ°ú7Í∏∏ 18-7", img: "32.png" },
  { no: 33, name: "YM Coffee Project", address: "ÏÑúÏö∏ ÏùÄÌèâÍµ¨ ÏßÑÍ¥Ä3Î°ú 67 ÎûòÎØ∏Ïïà9Îã®ÏßÄ ÏÉÅÍ∞ÄÎèô 1Ï∏µ 101Ìò∏", img: "33.png" },
  { no: 34, name: "Coffee Lusso", address: "ÏÑúÏö∏ Í∞ïÎÇ®Íµ¨ ÏÑ†Î¶âÎ°ú158Í∏∏ 16", img: "34.png" },
  { no: 35, name: "Guete Leute", address: "ÏÑúÏö∏ Í∞ïÎÇ®Íµ¨ ÏÑ†Î¶âÎ°ú131Í∏∏ 16", img: "35.png" },
  { no: 36, name: "Fromheras Dosan", address: "ÏÑúÏö∏ Í∞ïÎÇ®Íµ¨ Ïñ∏Ï£ºÎ°ú168Í∏∏ 29", img: "36.png" },
  { no: 37, name: "Bunker Company", address: "ÏÑúÏö∏ Í∞ïÎÇ®Íµ¨ Ïñ∏Ï£ºÎ°ú167Í∏∏ 23", img: "37.png" },
  { no: 38, name: "Cafe South Yarra", address: "ÏÑúÏö∏ Í¥ëÏßÑÍµ¨ Ïö©ÎßàÏÇ∞Î°ú3Í∏∏ 29 1Ï∏µ", img: "38.png" },
  { no: 39, name: "Camouflage", address: "ÏÑúÏö∏ ÏÑ±ÎèôÍµ¨ ÏïÑÏ∞®ÏÇ∞Î°ú1Í∏∏ 9", img: "39.png" },
  { no: 40, name: "Bugler Coffee", address: "ÏÑúÏö∏ Í¥ëÏßÑÍµ¨ Ï≤úÌò∏ÎåÄÎ°ú127Í∏∏ 74", img: "40.png" }
];
    // Ïó¨Í∏∞Ïóê ÎÇòÎ®∏ÏßÄ 80Í∞ú Ï£ºÏÜå Í∑∏ÎåÄÎ°ú Ï∂îÍ∞Ä Í∞ÄÎä•
  ];

  function filterByRegion(region) {
    alert("ÌïÑÌÑ∞: " + region);
  }

  function filterByCup(cup) {
    alert("ÌïÑÌÑ∞: " + cup);
  }

  function getDistance(lat1, lon1, lat2, lon2) {
    const R = 6371;
    const dLat = (lat2 - lat1) * Math.PI / 180;
    const dLon = (lon2 - lon1) * Math.PI / 180;
    const a = Math.sin(dLat / 2) ** 2 +
              Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *
              Math.sin(dLon / 2) ** 2;
    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
    return (R * c).toFixed(2);
  }

  async function getCoords(shop) {
    const url = `https://api.vworld.kr/req/address?service=address&request=getcoord&version=2.0&crs=epsg:4326&address=${encodeURIComponent(shop.address)}&refine=true&simple=false&format=json&type=road&key=${API_KEY}`;
    try {
      const res = await fetch(url);
      const data = await res.json();
      if (data.response?.status === "OK") {
        shop.lat = parseFloat(data.response.result.point.y);
        shop.lon = parseFloat(data.response.result.point.x);
      }
    } catch (e) {
      console.error("Ï¢åÌëú Î≥ÄÌôò Ïã§Ìå®:", shop.address, e);
    }
  }

  function renderShops(sortedShops) {
    const container = document.getElementById("coffee-list");
    container.innerHTML = "";
    sortedShops.forEach(shop => {
      const card = document.createElement("div");
      card.className = "coffee-card";
      card.innerHTML = `
        <img src="${shop.img}" alt="${shop.name}">
        <div class="name">${shop.name}</div>
        <div class="distance">${shop.distance || "Í≥ÑÏÇ∞Ï§ë..."}km</div>
      `;
      container.appendChild(card);
    });
  }

  async function init() {
    // 1. Ï£ºÏÜå ‚Üí ÏúÑÍ≤ΩÎèÑ Î≥ÄÌôò
    for (let shop of shops) {
      if (!shop.lat || !shop.lon) {
        await getCoords(shop);
      }
    }

    // 2. ÎÇ¥ ÏúÑÏπò Í∏∞Î∞ò Í±∞Î¶¨ Í≥ÑÏÇ∞
    if (!navigator.geolocation) return alert("ÏúÑÏπò Í∂åÌïúÏù¥ ÌïÑÏöîÌï©ÎãàÎã§!");
    navigator.geolocation.getCurrentPosition(pos => {
      const myLat = pos.coords.latitude;
      const myLon = pos.coords.longitude;

      shops.forEach(shop => {
        if (shop.lat && shop.lon) {
          shop.distance = getDistance(myLat, myLon, shop.lat, shop.lon);
        } else {
          shop.distance = "??";
        }
      });

      shops.sort((a, b) => parseFloat(a.distance) - parseFloat(b.distance));
      renderShops(shops);
    });
  }

  window.onload = () => {
    init();

    const input = document.querySelector('.search-container input');
    input.addEventListener('input', function () {
      const keyword = this.value.toLowerCase();
      const filtered = shops.filter(shop => shop.name.toLowerCase().includes(keyword));
      renderShops(filtered);
    });

    document.querySelectorAll(".dropdown").forEach(drop => {
      const button = drop.querySelector(".menu-button");
      const menu = drop.querySelector(".dropdown-content");
      button.addEventListener("click", (e) => {
        e.stopPropagation();
        const isVisible = menu.style.display === "block";
        document.querySelectorAll(".dropdown-content").forEach(m => m.style.display = "none");
        menu.style.display = isVisible ? "none" : "block";
      });
    });

    document.addEventListener("click", () => {
      document.querySelectorAll(".dropdown-content").forEach(m => m.style.display = "none");
    });
  };
</script>
</body>
</html>